---
csl: template/csl/elsevier-harvard.csl
bibliography: MHLW Rubella Nudge.bib
documentclass: article
papersize: a4
fontsize: 11pt
geometry: "left=3cm,right=3cm,top=3cm,bottom=3cm"
graphics: yes
indent: yes
linespace: 1.5
figurename: 図
tablename: 表
output:
  bookdown::pdf_document2:
    latex_engine: xelatex
    number_sections: yes
    keep_tex: yes
    fig_caption: yes
    toc: false
    dev: cairo_pdf
    extra_dependencies: ["float"]
    template: "template/tex/plain.tex"
  bookdown::word_document2:
    dev: png
params:
  preview: false
---

```{r render, eval = FALSE, include = FALSE, echo = FALSE}
rmarkdown::render(
  input = "webRCT.rmd",
  output_format = "all",
  output_dir = "publish/RIETI/webRCT",
  knit_root_dir = here::here()
)

# direct complie via tinytex
# tinytex::xelatex("publish/RIETI/webRCT/webRCT.tex")
```

```{r include = FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  warning = FALSE,
  echo = FALSE,
  cache = FALSE,
  include = TRUE,
  fig.pos = "t",
  fig.width = 10,
  fig.height = 6
)

format <- knitr::opts_knit$get("rmarkdown.pandoc.to")
out <- switch(format,
  "latex" = "kableExtra",
  "docx" = "flextable"
)

options(
  knitr.kable.NA = " ",
  knitr.table.format = "latex",
  modelsummary_stars_note = FALSE,
  modelsummary_format_numeric_latex = "plain"
)

library(systemfonts)
data.frame(unique(system_fonts()[, "family"]))
grDevices::windowsFonts(YuGothic = grDevices::windowsFont("Yu Gothic"))
```

# はじめに {#intro}

```{r child = "1-introduction.rmd"}

```

# 日本における風しんワクチンの背景 {#background}

```{r child = "2-background.rmd"}

```

# オンライン調査の概要 {#experiment}

```{r child = "3-experiment.r"}

```

```{r include=FALSE}
source("script/webRCT/_library.r")
web <- rct_data()
set_optRCTtool(
  RCTtool.plot_family = "YuGothic",
  RCTtool.table_fontsize = 9
)
```


# 分析結果 {#result}

```{r include = FALSE}
wave1 <- rct_data_wave1()
wave2 <- rct_data_wave2(1)

set_optRCTtool(
  basicmod = test_int + vaccine_int + aw1_test + aw1_testvaccine ~ nudge,
  xmod = ~ age + married + education +
    exercise_w1 + health_check + flushot +
    prob_social + handicap + severity +
    handwash + temp_check + avoid_out + avoid_crowd + wear_mask,
  data = web,
  ctrl = "厚労省"
)
```

```{r selection1_balance}
knitr::spin_child("script/webRCT/2-selection1_balance.R")
```

```{r selection1_main}
knitr::spin_child("script/webRCT/3-selection1_main.R")
```

```{r selection1_money}
knitr::spin_child("script/webRCT/4-selection1_money.R")
```

```{r selection1_nocoupon}
knitr::spin_child("script/webRCT/5-selection1_nocoupon.R")
```

# 議論と結論 {#conclusion}

本研究は、オンラインサーベイによるランダム化比較試験（RCT）を用いて、
風しんワクチンの接種を促進するためにどのようなナッジ・メッセージが有効であるかを明らかにした。
主な結果は以下の三つにまとめられる。
第一に、2019年度にクーポン券送付対象の年齢の男性のみに利他強調メッセージが抗体検査の受検を7.5%ポイント促進した。
このメッセージの効果を金銭的価値で評価すると、一人当たりの金銭的価値は約2000円（約18ドル）であり、
その総額は約100億円（約9,700万ドル）である。
この効果は個人の観察可能な特徴に対して頑健であり、
サンプルサイズが小さいことを考慮したフィッシャーの正確検定でも、
この効果は5%水準で有意である（表\@ref(tab:CtabTesterCoupon1)の第4列）。
また、利己強調メッセージや社会比較メッセージの抗体検査の受検比率は利他強調メッセージ群のそれと有意な差ではない。
この意味で、二つのメッセージも抗体検査の受検を促進した可能性がある。
しかしながら、抗体検査の受検比率の差は検出力を十分に保てるほどの大きさではないので、
サンプルサイズを増やした再検証が必要である。

第二に、介入群に関わらず、抗体検査の結果が陰性である人のほとんどはワクチンを接種していた。
これは、抗体保有率を高めるために、陰性である人のワクチン接種率を高めるような政策ではなく、
抗体検査の受検比率を高めるような政策の方が効率的であることを示唆している。
したがって、利他強調メッセージは抗体保有率を高めるためのナッジ・メッセージとして有効である。

第三に、2019年度にクーポン券がオンデマンドでしか送付されない年齢層の男性に対してナッジ・メッセージは機能しなかった。
考えられる可能性が二つある。
第一に、2019年度にクーポン券の送付対象ではない男性は厚生労働省の無料クーポン券制度を認知していないという点である。
第1回調査の調査票A（ナッジ・メッセージを示す前の調査）で、我々は厚生労働省のクーポン券制度の認知度を調査した。
その結果、2019年度にクーポン券の送付対象ではない年齢層の男性の約
`r with(subset(web, coupon2019 == 0), sprintf("%1.1f%%", sum(I(coupon == 3)) / sum(!is.na(coupon))  * 100)) `
が厚生労働省のクーポン券制度を知らなかった。
仮にナッジ・メッセージを読んで、風しんの抗体検査やワクチン接種を受ける必要性を理解したとしても、
クーポン券の存在を知らない人はそれらの予防行動を自費で受けないといけないと考えている。
ナッジ・メッセージは予防行動のコストを上回るほどその価値を高められなかったのかもしれない。
第二に、クーポン券制度を認知していて無料接種対象の年齢であったとしても、
2019年度にクーポン券の送付対象ではない年齢の男性は自治体にクーポン券を発行してもらうように依頼する必要があるという点である。
クーポン券制度を認知している男性が無料で抗体検査やワクチン接種を受けられることを知っていても、
クーポン券の発行の手続き自体にコストが伴う。
したがって、ナッジ・メッセージはクーポン券の発行の手続きのコストを上回るほどその価値を高められなかったのかもしれない。

分析結果について考慮すべき点が一つある。
ナッジ・メッセージの行動に対する効果を推定するとき、
我々はWave 2で前回のアンケート調査以前に抗体検査もしくはワクチン接種を受けたと回答した人を除いている。
しかしながら、この回答は想起バイアスを伴っている可能性がある。
もしそうならば、サンプルセレクションに想起バイアスが伴うので、
Wave 2でWave 1以前に抗体検査もしくはワクチン接種を受けたという人を除くべきではない。
したがって、想起バイアスを想定した分析では、Wave 1で過去に抗体検査もしくはワクチン接種を受けたと回答した人を除いたサブサンプルと、
抗体検査やワクチン接種を受けた時期に基づかないアウトカム変数を用いるべきである。
想起バイアスを想定した分析では、
効果・統計的な有意性・効果の金銭的価値は大きく異なるものの、
利他強調メッセージが抗体検査の受検を促進していることを確認している
（詳細な結果は補論Bに示した）。

最後に、新たなナッジ政策の方向性を議論しておく。
第一に、クーポン券を得ることで無料で抗体検査やワクチン接種を受けられること、
そして、その手続きの方法を分かりやすく伝えるようなナッジ・メッセージは有効かもしれない。
2019年度にクーポン券が配布されなかった男性に対して、
我々が開発したナッジ・メッセージは有効ではなかった。
先に述べたように、その原因はそもそもクーポン券制度の存在を知らなかった、
もしくはクーポン券の発行の手続きのコストが高いことにあると考えられる。
こうした問題点を解消するようなナッジ政策は有効だろう。
ただし、これは今回の厚生労働省の風しん対策特有の問題であることに注意したい。
第二に、実際は抗体を保有していないが、風しんに感染した経験があると思っていたり、ワクチンを接種したと思っていて、
抗体を保有していると誤って信じているような人の抗体検査の受検を促進することである。
抗体保有の誤った信念を正すようなナッジ政策がより効率的に政策目標を達成できるだろう。
このようなナッジ政策の効果検証が今後の研究課題となる。

\newpage

# 参考文献 {-}

<div id="refs"></div>

\newpage

# (APPENDIX) Appendix {-}

# 図表一覧 {#addtab}

```{r flowchart, ref.label="flowchart", fig.width = 25, fig.height=15, out.extra="angle=90", out.width="150%", fig.cap = "オンライン調査の概要"}
```

```{r covlist, ref.label="covlist"}
```

```{r BalanceWave1Coupon1, ref.label="BalanceWave1Coupon1"}
```

```{r BalanceWave2Coupon1, ref.label="BalanceWave2Coupon1"}
```

```{r BalanceWave1Coupon0, ref.label="BalanceWave1Coupon0"}
```

```{r BalanceWave2Coupon0, ref.label="BalanceWave2Coupon0"}
```

```{r AprioriPowerAnalysis, ref.label = "AprioriPowerAnalysis"}
```

```{r RegCoupon1, ref.label="RegCoupon1"}
```

```{r altbase-reg-coupon1, ref.label="altbase-reg-coupon1"}
```

```{r RegCoupon0, ref.label="RegCoupon0"}
```

\clearpage

# サンプルセレクションとアウトカム変数の定義を変更した分析

```{r include = FALSE}
wave2 <- rct_data_wave2(2)

set_optRCTtool(
  basicmod = abw1_test + abw1_testvaccine ~ nudge,
  data = web,
  ctrl = "厚労省",
)
```

```{r selection2_balance}
knitr::spin_child("script/webRCT/6-selection2_balance.R")
```

```{r selection2_main}
knitr::spin_child("script/webRCT/7-selection2_main.R")
```

```{r selection2_money}
knitr::spin_child("script/webRCT/8-selection2_money.R")
```

```{r selection2_nocoupon}
knitr::spin_child("script/webRCT/9-selection2_nocoupon.R")
```